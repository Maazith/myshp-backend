services:
  # Django Web Service - Starter Plan
  - type: web
    name: myshp-backend
    env: python
    plan: starter  # Starter plan - $7/month - 512MB RAM, 0.5 CPU
    buildCommand: bash build.sh
    startCommand: bash start.sh
    envVars:
      # Render environment detection
      - key: RENDER
        value: true
      - key: ENVIRONMENT
        value: production
      # Django settings
      - key: DEBUG
        value: False
      - key: SECRET_KEY
        generateValue: true
      # Database
      - key: DATABASE_URL
        fromDatabase:
          name: myshp-db
          property: connectionString
      # CORS and frontend URLs
      - key: VERCEL_FRONTEND_URL
        value: https://myshp-frontend.vercel.app
      - key: CORS_ALLOWED_ORIGINS
        value: https://edithcloths.com,https://www.edithcloths.com,https://myshp-frontend.vercel.app
      - key: CSRF_TRUSTED_ORIGINS
        value: https://edithcloths.com,https://www.edithcloths.com,https://myshp-frontend.vercel.app
      # Email configuration
      - key: EMAIL_HOST_PASSWORD
        sync: false  # Set manually in dashboard
      # Admin user creation
      - key: DJANGO_SUPERUSER_USERNAME
        value: Edithcloths
      - key: DJANGO_SUPERUSER_EMAIL
        value: edith0530s@gmail.com
      - key: DJANGO_SUPERUSER_PASSWORD
        value: edithcloths0530@2025./
    healthCheckPath: /api/products/

databases:
  # PostgreSQL Database - Free tier (can upgrade later)
  - name: myshp-db
    plan: free  # Free tier for PostgreSQL
    databaseName: myshp
    user: myshp_user

